// ============================================================================
// MD3 Icons System
// Version: 5.0.0 (MD3 Expressive 2025)
//
// Icon styling system for Material Symbols and custom SVG icons.
// Supports variable font icons with optical sizing, weight, grade, and fill.
// ============================================================================

// ============================================================================
// TABLE OF CONTENTS
// ============================================================================
// 1. Icon CSS Variables
// 2. Material Symbols Base
// 3. Icon Sizes
// 4. Icon Optical Sizing
// 5. Icon Weights
// 6. Icon Grades
// 7. Icon Fill States
// 8. Icon Colors
// 9. Icon Containers
// 10. Icon Buttons
// 11. Icon with Text
// 12. Animated Icons
// 13. SVG Icons
// 14. Icon Accessibility
// 15. Icon Mixins
// ============================================================================

// ============================================================================
// 1. ICON CSS VARIABLES
// ============================================================================

:root {
  // Base icon sizing
  --md-icon-size-xs: 16px;
  --md-icon-size-sm: 20px;
  --md-icon-size-md: 24px;
  --md-icon-size-lg: 32px;
  --md-icon-size-xl: 40px;
  --md-icon-size-2xl: 48px;
  --md-icon-size-3xl: 64px;

  // Default icon properties
  --md-icon-size: var(--md-icon-size-md);
  --md-icon-weight: 400;
  --md-icon-grade: 0;
  --md-icon-optical-size: 24;
  --md-icon-fill: 0;

  // Icon colors
  --md-icon-color: currentColor;
  --md-icon-color-primary: var(--md-sys-color-primary);
  --md-icon-color-secondary: var(--md-sys-color-secondary);
  --md-icon-color-tertiary: var(--md-sys-color-tertiary);
  --md-icon-color-error: var(--md-sys-color-error);
  --md-icon-color-success: var(--md-sys-color-primary);
  --md-icon-color-warning: var(--md-sys-color-tertiary);
  --md-icon-color-info: var(--md-sys-color-secondary);
  --md-icon-color-muted: var(--md-sys-color-on-surface-variant);
  --md-icon-color-disabled: var(--md-sys-color-on-surface);

  // Icon container
  --md-icon-container-size: 40px;
  --md-icon-container-radius: var(--md-sys-shape-corner-full, 9999px);
  --md-icon-container-bg: transparent;

  // Animation
  --md-icon-transition-duration: var(--md-sys-motion-duration-short, 200ms);
  --md-icon-transition-easing: var(--md-sys-motion-easing-standard, cubic-bezier(0.2, 0, 0, 1));
}

// ============================================================================
// 2. MATERIAL SYMBOLS BASE
// ============================================================================

// Material Symbols font-face (if self-hosting)
// @font-face {
//   font-family: 'Material Symbols Rounded';
//   font-style: normal;
//   font-weight: 100 700;
//   src: url('/fonts/material-symbols-rounded.woff2') format('woff2');
// }

// Base icon class
.material-symbols,
.material-symbols-rounded,
.material-symbols-outlined,
.material-symbols-sharp,
.md-icon {
  font-family: 'Material Symbols Rounded', sans-serif;
  font-weight: normal;
  font-style: normal;
  font-size: var(--md-icon-size);
  line-height: 1;
  letter-spacing: normal;
  text-transform: none;
  display: inline-block;
  white-space: nowrap;
  word-wrap: normal;
  direction: ltr;
  -webkit-font-feature-settings: 'liga';
  font-feature-settings: 'liga';
  -webkit-font-smoothing: antialiased;
  text-rendering: optimizeLegibility;
  -moz-osx-font-smoothing: grayscale;

  // Variable font settings
  font-variation-settings:
    'FILL' var(--md-icon-fill),
    'wght' var(--md-icon-weight),
    'GRAD' var(--md-icon-grade),
    'opsz' var(--md-icon-optical-size);

  // Default color
  color: var(--md-icon-color);

  // Prevent text selection
  user-select: none;

  // Smooth transitions
  transition:
    font-variation-settings var(--md-icon-transition-duration) var(--md-icon-transition-easing),
    color var(--md-icon-transition-duration) var(--md-icon-transition-easing),
    transform var(--md-icon-transition-duration) var(--md-icon-transition-easing);
}

// Outlined variant (default)
.material-symbols-outlined {
  --md-icon-fill: 0;
}

// Rounded variant
.material-symbols-rounded {
  font-family: 'Material Symbols Rounded', sans-serif;
}

// Sharp variant
.material-symbols-sharp {
  font-family: 'Material Symbols Sharp', sans-serif;
}

// ============================================================================
// 3. ICON SIZES
// ============================================================================

.icon-xs {
  --md-icon-size: var(--md-icon-size-xs);
  --md-icon-optical-size: 16;
  font-size: var(--md-icon-size-xs);
}

.icon-sm {
  --md-icon-size: var(--md-icon-size-sm);
  --md-icon-optical-size: 20;
  font-size: var(--md-icon-size-sm);
}

.icon-md {
  --md-icon-size: var(--md-icon-size-md);
  --md-icon-optical-size: 24;
  font-size: var(--md-icon-size-md);
}

.icon-lg {
  --md-icon-size: var(--md-icon-size-lg);
  --md-icon-optical-size: 32;
  font-size: var(--md-icon-size-lg);
}

.icon-xl {
  --md-icon-size: var(--md-icon-size-xl);
  --md-icon-optical-size: 40;
  font-size: var(--md-icon-size-xl);
}

.icon-2xl {
  --md-icon-size: var(--md-icon-size-2xl);
  --md-icon-optical-size: 48;
  font-size: var(--md-icon-size-2xl);
}

.icon-3xl {
  --md-icon-size: var(--md-icon-size-3xl);
  --md-icon-optical-size: 48;
  font-size: var(--md-icon-size-3xl);
}

// ============================================================================
// 4. ICON OPTICAL SIZING
// ============================================================================

// Optical size adjusts icon details for better clarity at different sizes
.icon-opsz-20 {
  --md-icon-optical-size: 20;
}

.icon-opsz-24 {
  --md-icon-optical-size: 24;
}

.icon-opsz-40 {
  --md-icon-optical-size: 40;
}

.icon-opsz-48 {
  --md-icon-optical-size: 48;
}

// ============================================================================
// 5. ICON WEIGHTS
// ============================================================================

.icon-weight-100 {
  --md-icon-weight: 100;
}

.icon-weight-200 {
  --md-icon-weight: 200;
}

.icon-weight-300 {
  --md-icon-weight: 300;
}

.icon-weight-400 {
  --md-icon-weight: 400;
}

.icon-weight-500 {
  --md-icon-weight: 500;
}

.icon-weight-600 {
  --md-icon-weight: 600;
}

.icon-weight-700 {
  --md-icon-weight: 700;
}

// Semantic weight classes
.icon-thin {
  --md-icon-weight: 100;
}

.icon-light {
  --md-icon-weight: 300;
}

.icon-regular {
  --md-icon-weight: 400;
}

.icon-medium {
  --md-icon-weight: 500;
}

.icon-bold {
  --md-icon-weight: 700;
}

// ============================================================================
// 6. ICON GRADES
// ============================================================================

// Grade adjusts icon weight for dark/light backgrounds
// Negative: lighter weight (for dark backgrounds)
// Positive: heavier weight (for light backgrounds)

.icon-grade-low {
  --md-icon-grade: -25;
}

.icon-grade-normal {
  --md-icon-grade: 0;
}

.icon-grade-high {
  --md-icon-grade: 200;
}

// Auto-adjust grade based on background
.icon-grade-auto {
  --md-icon-grade: 0;

  @media (prefers-color-scheme: dark) {
    --md-icon-grade: -25;
  }
}

// ============================================================================
// 7. ICON FILL STATES
// ============================================================================

// Outlined (default)
.icon-outlined {
  --md-icon-fill: 0;
}

// Filled
.icon-filled {
  --md-icon-fill: 1;
}

// Interactive fill on hover/active
.icon-fill-on-hover {
  --md-icon-fill: 0;

  &:hover {
    --md-icon-fill: 1;
  }
}

.icon-fill-on-active {
  --md-icon-fill: 0;

  &:active,
  &.active,
  &[aria-pressed="true"],
  &[aria-selected="true"] {
    --md-icon-fill: 1;
  }
}

// ============================================================================
// 8. ICON COLORS
// ============================================================================

.icon-primary {
  --md-icon-color: var(--md-icon-color-primary);
  color: var(--md-icon-color-primary);
}

.icon-secondary {
  --md-icon-color: var(--md-icon-color-secondary);
  color: var(--md-icon-color-secondary);
}

.icon-tertiary {
  --md-icon-color: var(--md-icon-color-tertiary);
  color: var(--md-icon-color-tertiary);
}

.icon-error {
  --md-icon-color: var(--md-icon-color-error);
  color: var(--md-icon-color-error);
}

.icon-success {
  --md-icon-color: var(--md-icon-color-success);
  color: var(--md-icon-color-success);
}

.icon-warning {
  --md-icon-color: var(--md-icon-color-warning);
  color: var(--md-icon-color-warning);
}

.icon-info {
  --md-icon-color: var(--md-icon-color-info);
  color: var(--md-icon-color-info);
}

.icon-muted {
  --md-icon-color: var(--md-icon-color-muted);
  color: var(--md-icon-color-muted);
}

.icon-disabled {
  --md-icon-color: var(--md-icon-color-disabled);
  color: var(--md-icon-color-disabled);
  opacity: 0.38;
}

.icon-on-primary {
  --md-icon-color: var(--md-sys-color-on-primary);
  color: var(--md-sys-color-on-primary);
}

.icon-on-secondary {
  --md-icon-color: var(--md-sys-color-on-secondary);
  color: var(--md-sys-color-on-secondary);
}

.icon-on-surface {
  --md-icon-color: var(--md-sys-color-on-surface);
  color: var(--md-sys-color-on-surface);
}

.icon-inherit {
  --md-icon-color: inherit;
  color: inherit;
}

// ============================================================================
// 9. ICON CONTAINERS
// ============================================================================

// Circle container
.icon-container {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: var(--md-icon-container-size);
  height: var(--md-icon-container-size);
  border-radius: var(--md-icon-container-radius);
  background: var(--md-icon-container-bg);
  flex-shrink: 0;
}

// Container size variants
.icon-container-sm {
  --md-icon-container-size: 32px;
}

.icon-container-md {
  --md-icon-container-size: 40px;
}

.icon-container-lg {
  --md-icon-container-size: 48px;
}

.icon-container-xl {
  --md-icon-container-size: 56px;
}

// Container color variants
.icon-container-primary {
  --md-icon-container-bg: var(--md-sys-color-primary-container);
  --md-icon-color: var(--md-sys-color-on-primary-container);
}

.icon-container-secondary {
  --md-icon-container-bg: var(--md-sys-color-secondary-container);
  --md-icon-color: var(--md-sys-color-on-secondary-container);
}

.icon-container-tertiary {
  --md-icon-container-bg: var(--md-sys-color-tertiary-container);
  --md-icon-color: var(--md-sys-color-on-tertiary-container);
}

.icon-container-error {
  --md-icon-container-bg: var(--md-sys-color-error-container);
  --md-icon-color: var(--md-sys-color-on-error-container);
}

.icon-container-surface {
  --md-icon-container-bg: var(--md-sys-color-surface-container);
  --md-icon-color: var(--md-sys-color-on-surface);
}

// Square container
.icon-container-square {
  border-radius: var(--md-sys-shape-corner-medium, 12px);
}

// ============================================================================
// 10. ICON BUTTONS
// ============================================================================

.icon-btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 48px;
  height: 48px;
  padding: 0;
  border: none;
  border-radius: var(--md-sys-shape-corner-full, 9999px);
  background: transparent;
  color: var(--md-icon-color);
  cursor: pointer;
  position: relative;
  overflow: hidden;

  // State layer
  &::before {
    content: '';
    position: absolute;
    inset: 0;
    background: currentColor;
    opacity: 0;
    transition: opacity var(--md-icon-transition-duration) var(--md-icon-transition-easing);
  }

  &:hover::before {
    opacity: var(--md-sys-state-hover-opacity, 0.08);
  }

  &:focus-visible::before {
    opacity: var(--md-sys-state-focus-opacity, 0.12);
  }

  &:active::before {
    opacity: var(--md-sys-state-pressed-opacity, 0.12);
  }

  // Focus ring
  &:focus-visible {
    outline: 3px solid var(--md-sys-color-primary);
    outline-offset: 2px;
  }

  // Disabled state
  &:disabled {
    color: var(--md-sys-color-on-surface);
    opacity: 0.38;
    cursor: not-allowed;

    &::before {
      display: none;
    }
  }

  // Icon inside
  .material-symbols,
  .md-icon {
    position: relative;
    z-index: 1;
  }
}

// Icon button size variants
.icon-btn-sm {
  width: 40px;
  height: 40px;

  .material-symbols,
  .md-icon {
    font-size: 20px;
  }
}

.icon-btn-lg {
  width: 56px;
  height: 56px;

  .material-symbols,
  .md-icon {
    font-size: 28px;
  }
}

// Filled icon button
.icon-btn-filled {
  background: var(--md-sys-color-primary);
  color: var(--md-sys-color-on-primary);
}

// Tonal icon button
.icon-btn-tonal {
  background: var(--md-sys-color-secondary-container);
  color: var(--md-sys-color-on-secondary-container);
}

// Outlined icon button
.icon-btn-outlined {
  border: 1px solid var(--md-sys-color-outline);
}

// ============================================================================
// 11. ICON WITH TEXT
// ============================================================================

// Icon before text
.icon-text {
  display: inline-flex;
  align-items: center;
  gap: 8px;

  .material-symbols,
  .md-icon {
    flex-shrink: 0;
  }
}

// Icon after text
.text-icon {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  flex-direction: row-reverse;

  .material-symbols,
  .md-icon {
    flex-shrink: 0;
  }
}

// Stacked (icon above text)
.icon-text-stacked {
  display: inline-flex;
  flex-direction: column;
  align-items: center;
  gap: 4px;
  text-align: center;
}

// ============================================================================
// 12. ANIMATED ICONS
// ============================================================================

// Spin animation
.icon-spin {
  animation: icon-spin 1s linear infinite;
}

@keyframes icon-spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

// Pulse animation
.icon-pulse {
  animation: icon-pulse 1.5s ease-in-out infinite;
}

@keyframes icon-pulse {
  0%, 100% {
    opacity: 1;
  }
  50% {
    opacity: 0.5;
  }
}

// Bounce animation
.icon-bounce {
  animation: icon-bounce 1s ease infinite;
}

@keyframes icon-bounce {
  0%, 100% {
    transform: translateY(0);
  }
  50% {
    transform: translateY(-4px);
  }
}

// Shake animation
.icon-shake {
  animation: icon-shake 0.5s ease-in-out;
}

@keyframes icon-shake {
  0%, 100% {
    transform: translateX(0);
  }
  25% {
    transform: translateX(-4px);
  }
  75% {
    transform: translateX(4px);
  }
}

// Scale on hover
.icon-scale-hover {
  transition: transform var(--md-icon-transition-duration) var(--md-icon-transition-easing);

  &:hover {
    transform: scale(1.1);
  }
}

// Rotate on hover
.icon-rotate-hover {
  transition: transform var(--md-icon-transition-duration) var(--md-icon-transition-easing);

  &:hover {
    transform: rotate(15deg);
  }
}

// Flip on hover
.icon-flip-hover {
  transition: transform var(--md-icon-transition-duration) var(--md-icon-transition-easing);

  &:hover {
    transform: scaleX(-1);
  }
}

// Reduced motion
@media (prefers-reduced-motion: reduce) {
  .icon-spin,
  .icon-pulse,
  .icon-bounce,
  .icon-shake {
    animation: none;
  }

  .icon-scale-hover,
  .icon-rotate-hover,
  .icon-flip-hover {
    transition: none;

    &:hover {
      transform: none;
    }
  }
}

// ============================================================================
// 13. SVG ICONS
// ============================================================================

// Base SVG icon
.svg-icon {
  display: inline-block;
  width: var(--md-icon-size);
  height: var(--md-icon-size);
  fill: currentColor;
  stroke: none;
  flex-shrink: 0;
}

// SVG icon with stroke
.svg-icon-stroke {
  fill: none;
  stroke: currentColor;
  stroke-width: 2;
  stroke-linecap: round;
  stroke-linejoin: round;
}

// SVG icon sizes
.svg-icon-xs {
  width: var(--md-icon-size-xs);
  height: var(--md-icon-size-xs);
}

.svg-icon-sm {
  width: var(--md-icon-size-sm);
  height: var(--md-icon-size-sm);
}

.svg-icon-md {
  width: var(--md-icon-size-md);
  height: var(--md-icon-size-md);
}

.svg-icon-lg {
  width: var(--md-icon-size-lg);
  height: var(--md-icon-size-lg);
}

.svg-icon-xl {
  width: var(--md-icon-size-xl);
  height: var(--md-icon-size-xl);
}

// ============================================================================
// 14. ICON ACCESSIBILITY
// ============================================================================

// Decorative icon (hidden from screen readers)
.icon-decorative {
  [aria-hidden="true"] {
    // Already handled by aria-hidden
  }
}

// Icon with accessible label
.icon-labeled {
  // Requires aria-label on parent
}

// Screen reader text for icon
.icon-sr-text {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

// High contrast mode
@media (forced-colors: active) {
  .material-symbols,
  .md-icon,
  .svg-icon {
    forced-color-adjust: auto;
  }

  .icon-container {
    border: 1px solid currentColor;
  }
}

// ============================================================================
// 15. ICON MIXINS
// ============================================================================

// Icon size mixin
@mixin icon-size($size, $optical-size: null) {
  --md-icon-size: #{$size};
  font-size: $size;

  @if $optical-size {
    --md-icon-optical-size: #{$optical-size};
  }
}

// Icon color mixin
@mixin icon-color($color) {
  --md-icon-color: #{$color};
  color: $color;
}

// Icon container mixin
@mixin icon-container($size: 40px, $bg: transparent, $radius: 9999px) {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: $size;
  height: $size;
  border-radius: $radius;
  background: $bg;
}

// Icon button mixin
@mixin icon-button($size: 48px) {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: $size;
  height: $size;
  padding: 0;
  border: none;
  border-radius: 9999px;
  background: transparent;
  cursor: pointer;

  &:focus-visible {
    outline: 3px solid var(--md-sys-color-primary);
    outline-offset: 2px;
  }
}

// Material symbol mixin
@mixin material-symbol($fill: 0, $weight: 400, $grade: 0, $optical-size: 24) {
  font-variation-settings:
    'FILL' #{$fill},
    'wght' #{$weight},
    'GRAD' #{$grade},
    'opsz' #{$optical-size};
}
