<div class="blog-page">
  <!-- Hero Section -->
  <app-hero-section
    titleKey="BLOG.TITLE"
    subtitleKey="BLOG.SUBTITLE"
    imageUrl="/assets/images/blog-hero.jpg"
  ></app-hero-section>

  <div class="container">
    <!-- Search and Filter Section -->
    <div class="filter-section">
      <div class="search-container">
        <div class="md3-text-field md3-text-field-outlined search-field">
          <input
            type="text"
            class="md3-text-field__input"
            [(ngModel)]="searchQuery"
            (input)="onSearchChange()"
            [placeholder]="'BLOG.SEARCH_PLACEHOLDER' | translate"
            id="search-input"
          />
          <label class="md3-text-field__label" for="search-input">{{ 'BLOG.SEARCH_PLACEHOLDER' | translate }}</label>
          <span class="material-icons-rounded md3-text-field__icon md3-text-field__icon--trailing">search</span>
        </div>
      </div>

      <div class="category-filter">
        <div class="md3-select">
          <select
            class="md3-select__input"
            [(ngModel)]="selectedCategory"
            (change)="onCategoryChange()"
            id="category-select"
          >
            <option value="">{{ 'BLOG.CATEGORY_FILTER' | translate }}</option>
            <option *ngFor="let category of categories" [value]="category">
              {{ category }}
            </option>
          </select>
          <label class="md3-select__label" for="category-select">{{ 'BLOG.CATEGORY_FILTER' | translate }}</label>
        </div>
      </div>

      <button class="md3-button md3-button-outlined clear-filters-btn" (click)="clearFilters()">
        <span class="material-icons-rounded">clear</span>
        {{ 'BLOG.CLEAR_FILTERS' | translate }}
      </button>
    </div>

    <!-- Featured Articles -->
    <section class="featured-section" *ngIf="!searchQuery && !selectedCategory">
      <h2>{{ 'BLOG.FEATURED_ARTICLES' | translate }}</h2>
      <div class="featured-grid">
        <div
          *ngFor="let article of featuredArticles$ | async; trackBy: trackByArticleId"
          class="md3-card featured-card"
          [routerLink]="['/blog', article.slug]"
        >
          <div class="article-image">
            <img [src]="article.image" [alt]="article.title" loading="lazy" />
          </div>
          <div class="md3-card__header">
            <h3 class="md3-card__title">{{ article.title }}</h3>
            <p class="md3-card__subtitle">
              {{ article.date }} • {{ article.readTime }} {{ 'BLOG.MIN_READ' | translate }}
            </p>
          </div>
          <div class="md3-card__content">
            <p>{{ article.excerpt }}</p>
            <div class="article-meta">
              <div class="md3-chip-group">
                <span class="md3-chip md3-chip-filter" *ngFor="let tag of article.tags.slice(0, 3)">
                  {{ tag }}
                </span>
              </div>
            </div>
          </div>
          <div class="md3-card__actions">
            <button class="md3-button md3-button-text">
              {{ 'BLOG.READ_MORE' | translate }}</button>
          </div>
        </div>
      </div>
    </section>

    <!-- All Articles -->
    <section class="articles-section">
      <h2 *ngIf="searchQuery || selectedCategory">
        {{
          searchQuery ? ('BLOG.SEARCH_RESULTS' | translate) : ('BLOG.CATEGORY_ARTICLES' | translate)
        }}
      </h2>
      <h2 *ngIf="!searchQuery && !selectedCategory">{{ 'BLOG.ALL_ARTICLES' | translate }}</h2>

      <div class="articles-grid">
        <div
          *ngFor="let article of articles$ | async; trackBy: trackByArticleId"
          class="article-card"
          [routerLink]="['/blog', article.slug]"
        >
          <div class="article-image">
            <img [src]="article.image" [alt]="article.title" loading="lazy" />
          </div>
          <div class="md3-card__header">
            <h3 class="md3-card__title">{{ article.title }}</h3>
            <p class="md3-card__subtitle">
              {{ article.date }} • {{ article.readTime }} {{ 'BLOG.MIN_READ' | translate }}
            </p>
          </div>
          <div class="md3-card__content">
            <p>{{ article.excerpt }}</p>
            <div class="article-meta">
              <span class="category">{{ article.category }}</span>
              <div class="md3-chip-group">
                <span class="md3-chip md3-chip-filter" *ngFor="let tag of article.tags.slice(0, 2)">
                  {{ tag }}
                </span>
              </div>
            </div>
          </div>
          <div class="md3-card__actions">
            <button class="md3-button md3-button-text">
              {{ 'BLOG.READ_MORE' | translate }}</button>
          </div>
        </div>
      </div>
    </section>
  </div>
</div>
