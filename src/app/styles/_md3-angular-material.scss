// Angular Material MD3 Theme Configuration
// ==========================================
// Integrates Angular Material 18+ with our custom MD3 design system

@use '@angular/material' as mat;
@use 'sass:map';

// Include core Angular Material styles
@include mat.core();

// Our brand colors
$brand-teal: var(--md-sys-color-primary);
$brand-amber: var(--md-sys-color-secondary);
$brand-coral: var(--md-sys-color-tertiary);

// Define MD3 theme configuration
$md3-light-theme: mat.define-theme((
  color: (
    theme-type: light,
    primary: mat.$cyan-palette,      // Closest to our teal
    secondary: mat.$amber-palette,   // Matches our amber
    tertiary: mat.$orange-palette,   // Close to coral
    use-system-variables: true,
  ),
  typography: (
    brand-family: 'Figtree, sans-serif',
    plain-family: 'var(--md-sys-typescale-font-plain)',
    bold-weight: 700,
    medium-weight: 500,
    regular-weight: 400,
  ),
  density: (
    scale: 0, // 0 = comfortable, -1 = compact, -2 = dense
  ),
));

// Dark theme variant
$md3-dark-theme: mat.define-theme((
  color: (
    theme-type: dark,
    primary: mat.$cyan-palette,
    secondary: mat.$amber-palette,
    tertiary: mat.$orange-palette,
    use-system-variables: true,
  ),
  typography: (
    brand-family: 'Figtree, sans-serif',
    plain-family: 'var(--md-sys-typescale-font-plain)',
    bold-weight: 700,
    medium-weight: 500,
    regular-weight: 400,
  ),
  density: (
    scale: 0,
  ),
));

// Apply light theme by default
@include mat.all-component-themes($md3-light-theme);

// Dark mode support
@media (prefers-color-scheme: dark) {
  @include mat.all-component-colors($md3-dark-theme);
}

// Manual dark mode class
.dark-mode {
  @include mat.all-component-colors($md3-dark-theme);
}

// Custom component theming
.mat-mdc-button {
  // Align with our custom button styles
  &.mat-mdc-button-base {
    font-family: var(--md-sys-typescale-font-plain);
    font-weight: 500;
    letter-spacing: 0.1px;
    border-radius: var(--md-sys-shape-corner-full); // Full rounded
  }
}

.mat-mdc-card {
  // Align with our card styles
  border-radius: var(--md-sys-shape-corner-medium);
  transition: all 300ms cubic-bezier(0.2, 0, 0, 1);
  
  &:hover {
    box-shadow: 
      0px 2px 4px rgba(var(--md-sys-color-shadow), 0.2),
      0px 4px 8px 2px rgba(var(--md-sys-color-shadow), 0.1);
  }
}

// FAB customization
.mat-mdc-fab,
.mat-mdc-mini-fab {
  border-radius: var(--md-sys-shape-corner-large) !important; // MD3 large corner
  
  &.mat-primary {
    background-color: $brand-teal;
  }
  
  &.mat-accent {
    background-color: $brand-amber;
  }
}

// Form field customization
.mat-mdc-form-field {
  font-family: var(--md-sys-typescale-font-plain);
  
  .mat-mdc-floating-label {
    font-family: var(--md-sys-typescale-font-plain);
  }
}

// Chip customization
.mat-mdc-chip {
  border-radius: var(--md-sys-shape-corner-small); // MD3 small corner
  font-family: var(--md-sys-typescale-font-plain);
  
  &.mat-mdc-chip-selected {
    background-color: rgba($brand-teal, 0.12);
  }
}

// Dialog customization
.mat-mdc-dialog-container {
  border-radius: var(--md-sys-shape-corner-extra-large); // MD3 extra-large corner
  
  .mat-mdc-dialog-title {
    font-family: var(--md-sys-typescale-font-brand);
    font-weight: 600;
  }
}

// List customization
.mat-mdc-list-item {
  font-family: var(--md-sys-typescale-font-plain);
  transition: background-color 200ms ease;
  
  &:hover {
    background-color: rgba($brand-teal, 0.08);
  }
  
  &.active {
    background-color: rgba($brand-teal, 0.12);
  }
}

// Navigation customization
.mat-mdc-tab-group {
  .mat-mdc-tab {
    font-family: var(--md-sys-typescale-font-plain);
    font-weight: 500;
  }
}

.mat-sidenav {
  width: 360px; // MD3 standard drawer width
  border-radius: 0 16px 16px 0;
}

// Toolbar customization
.mat-toolbar {
  font-family: var(--md-sys-typescale-font-brand);
  
  &.mat-primary {
    background-color: $brand-teal;
  }
}

// Snackbar customization
.mat-mdc-snack-bar-container {
  border-radius: var(--md-sys-shape-corner-small);
  
  .mat-mdc-snack-bar-label {
    font-family: var(--md-sys-typescale-font-plain);
  }
}

// Progress indicators
.mat-mdc-progress-bar,
.mat-mdc-progress-spinner {
  &.mat-primary {
    --mdc-linear-progress-active-indicator-color: #{$brand-teal};
    --mdc-circular-progress-active-indicator-color: #{$brand-teal};
  }
}

// Export theme for use in components
$app-theme: $md3-light-theme;